{% extends "base.html" %}
{% load extra_tags %}

//************************************************
// Attach page-specific javascripts
//************************************************

{% block javascript %}
<link rel="stylesheet" href="/static_media/css/autoSuggest.css" type="text/css"
	media="screen" />
<script src="/static_media/js/jquery.tablesorter.min.js" type="text/javascript"></script>
<script type="text/javascript" src="/static_media/js/jquery.equalHeight.js"></script>
<script type="text/javascript" src="/static_media/js/jquery.autoSuggest.packed.js"></script>
<script type="text/javascript">
	/* Make all columns equal height */
	$(function() {
		$('.column').equalHeight();
	});
	
	/* Add item to auto sugget to exp_list and make ready*/
	var itemList = new Array();
	var tmp;
	{% for bench in speccpu %}
		tmp = {value: "{{ bench }}", name: "{{ bench }}"};
		itemList.push(tmp);
	{% endfor %}
	
	var data = {items : itemList};
	$(function() {
		$('#excl_bench').autoSuggest(data.items,
			{selectedItemProp: "name", 
			searchObjProps: "name",
			startText: "Enter benchmarks to exclude",
			asHtmlID: "1"});
	});
	
	/* Add item to auto sugget to baseExpList and make ready*/
	var baseExpList = new Array();
	var tmp;
	{% for cur in baseExp %}
		tmp = {value: "{{ cur }}", name: "{{ cur }}"};
		baseExpList.push(tmp);		
	{% endfor %}
	var expData = {items : baseExpList};
	$(function() {
		$('#baseExp').autoSuggest(expData.items,
			{selectedItemProp: "name", 
			searchObjProps: "name",
			startText: "Enter experiment types to run",
			asHtmlID: "2"});
	});

	/* Add item to auto sugget to extExpList and make ready*/
	var extExpList = new Array();
	var tmp;
	{% for cur in extExp %}
		tmp = {value: "{{ cur }}", name: "{{ cur }}"};
		extExpList.push(tmp);		
	{% endfor %}
	var extData = {items : extExpList};
	$(function() {
		$('#extExp').autoSuggest(extData.items,
			{selectedItemProp: "name", 
			searchObjProps: "name",
			startText: "Choose extended experiment types to EXCLUDE",
			asHtmlID: "3"});
	});
</script>
{% endblock %}

//************************************************
// Javascripts to run on document ready
//************************************************

{% block onready %}
$(".tablesorter").tablesorter();
$("#accordion").tabs("#accordion div.pane", {
	tabs : 'h2',
	effect : 'slide',
	initialIndex : null
});

// ******** Make select all clickable ********
 $('.checkall').click(
		function() {
			$(this).parents('fieldset:eq(0)').find(':checkbox')
					.attr('checked', this.checked);
});
 
// ********** Submit needed values to server **********

 $('#run').click(
 	function() {
 		var suite = $("select#bench").val();
 		suite = "#" + suite + 'form';
 		$(suite).find("td").each(function() {
 			$(this).find("input").attr("name",$(this).text());
 		});
 		$("#argtable").find("tbody > tr > .edit").each(function() {
 			var input = $("<input>").attr("type", "hidden").attr("name", $(this).attr('name')).val($(this).html());
 			$('#argtable').append($(input));
 		});
 }); 
{% endblock %}

//************************************************
// Breadcrumbs
//************************************************
{% block breadcrumbs %}
<div class="breadcrumbs_container">
	<article class="breadcrumbs">
		<a href="/config">New Simulation</a>
		<div class="breadcrumb_divider"></div>
		<a href="/config/getCondor">Condor Status</a>
	</article>
</div>
{% endblock %}

//************************************************
// Config block contents
//************************************************
{% block content %}
<section id="main" class="column">
<form name="argForm" id="argForm" action="runExp" method="post" enctype="multipart/form-data">
	<article class="module width_full">
	<div id="accordion">
		<header>
		<h2 class="current">Arguments</h2>
		</header>
		<div class="pane" style="display: block">

			<!-- EXPERIMENT NAME -->
			<fieldset>
				<label>Experiment Name</label> <b style="margin-left:10px">{{ expName }}</b>
				<input type="hidden" id="expName" name="expName" value="{{ expName }}" />
			</fieldset>
			
			<!-- END PATH TO EXECUTABLE -->
			
			<!-- PATH TO EXECUTABLE -->
			<fieldset>
				{{ binFile }}
			</fieldset>
			<!-- END PATH TO EXECUTABLE -->

			
			<!-- BENCHMARK SUITES -->
			<fieldset>
				<label>Benchmark suite </label> <select id="bench"
					onchange="showForm()" name="benchsuite">
					<option value="speccpu">speccpu</option>
					<option value="spec2006">spec2006</option>
				</select>
			</fieldset>
			<!-- END BENCHMARK SUITES -->
			
			<!-- START SIZE PREF -->
			<fieldset>
				<label>Size Preference</label>
				<span style="margin-left:10px">sizepref : </span><br /><input type="text" name="size_pref" id="size_pref" value="100M" />
				<span style="margin-left:10px">size :</span><input type="text" name="size" id="size" value="100000000" />
			</fieldset>
			<!-- END SIZE PREF -->
			
			<!-- START COMMON ARGUMENT -->
			<fieldset>
				<label> Common Arguments</label>
				<textarea id="common" name="common" rows=4">-restore true -warmup_insns 10000000 -heartbeat_cycles 100000 -heartbeat_insns 100000 -insn_limit #{size} -validator true -mem_accurate_model true -pref true -pref_stride true
				</textarea>
			</fieldset>
			<!-- END COMMON ARGUMENT -->
			
			<!-- START EXPERIMENT TYPE BASE -->
			<fieldset>
				<label>Base Experiment Types</label>
				<input type="text" id="baseExp" name="baseExp">
			</fieldset>
			<!-- END EXPERIMENT TYPE BASE -->
			
			<!-- START EXPERIMENT TYPE EXTENDED -->
			<fieldset>
					<label>Extended Experiment Types to EXCLUDE</label>
					<input type="text" id="extExp" name="extExp">
				</fieldset>
			<!-- END EXPERIMENT TYPE EXTENDED -->
		</div>
		<header>
		<h2>Miscellaneous Configurations</h2>
		</header>
		<div class="pane">
			<fieldset>
				<label>Use output / error / log</label>
				<input type="checkbox" class="usevalues" id="useOut" name="useOut" /> Use Output <br />
				<input type="checkbox" class="usevalues" id="useErr" name="useErr" /> Use Error <br />
				<input type="checkbox" class="usevalues" id="useLog" name="useLog" /> Use Log <br />
			</fieldset>
			
			<fieldset>
				<label> Benchmarks to Exclude </label>
				<input type="text" id="excl_bench" name="excl_bench">
			</fieldset>
			
			<fieldset>
			<label> pcm options </label>
				<input type="text" id="pcm_options" name="pcm_options" value="-mem_multiplier 16">
			</fieldset>
		</div>
	</div>
	</article>
	<!-- end of pane article -->
	<div class="spacer"></div>
	<input type="submit" id="run" value="Run Experiment">
</section>
</form>
{% endblock %}
